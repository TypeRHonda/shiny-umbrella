#!/usr/bin/nodejsconst fs = require('fs');const dir = fs.readdirSync("./indexes");const exec = require('child_process').exec;var JSON = null; var mkdirSync = function (path) {  try {    fs.mkdirSync(path);  } catch(e) {    if ( e.code != 'EEXIST' ) throw e;  }}var DoTheThing = function (path) {	mkdirSync("./figured_out");	for (i=0;i<dir.length;i+=1){	    var stuffs = JSON.parse(fs.readFileSync('./indexes/'+dir[i], 'utf8'));	    for (filename in stuffs["objects"]) {	        var folders = filename.split("/");	        folders[0] = "./figured_out/" + folders[0];	        for (ii=0;ii<(folders.length-1);ii+=1){	            folders[ii+1] = folders[ii] + "/" + folders[ii+1];	        }	        for (ii=0;ii<(folders.length-1);ii+=1){	            mkdirSync(folders[ii]);	        }	        fs.writeFileSync(folders[folders.length-1], fs.readFileSync('./objects/'+stuffs["objects"][filename]["hash"].substring(0, 2)+"/"+stuffs["objects"][filename]["hash"], null), null);	        console.log(stuffs["objects"][filename]["hash"]+"->"+folders[folders.length-1])	    }	}}
try{	JSON = require('json-comments');	//JSON = require('json');	DoTheThing();}catch(ex){	// executes `pwd`	child = exec("npm install json-comments", function (error, stdout, stderr) {		console.log('stdout: ' + stdout);		console.log('stderr: ' + stderr);		if (error == null) {			JSON = require('json-comments');			DoTheThing();		}else{			console.log('exec error: ' + error);		}	});}
